{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home \u00b6 This supporting add-on comes with prebuilt content for AWS asset data to be easily used with Splunk Enterprise Security's asset database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with AWS, Inc. and is not sponsored or sanctioned by the AWS team. As such, the included documentation does not contain information on how to get started with AWS. Rather, this documentation serves as a guide to use AWS asset data with Splunk Enterprise Security. Please visit https://aws.amazon.com/ for more information about AWS. Assumptions \u00b6 This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have AWS device data ingested and the Splunk Add-on for AWS is installed. Familiarity with setting up a new Asset source in Enterprise Security. About \u00b6 Info Description SA-AwsAssets 1.0.2 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x Splunk Add-on for AWS (Required) 6.x Quick Start","title":"Home"},{"location":"#home","text":"This supporting add-on comes with prebuilt content for AWS asset data to be easily used with Splunk Enterprise Security's asset database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with AWS, Inc. and is not sponsored or sanctioned by the AWS team. As such, the included documentation does not contain information on how to get started with AWS. Rather, this documentation serves as a guide to use AWS asset data with Splunk Enterprise Security. Please visit https://aws.amazon.com/ for more information about AWS.","title":"Home"},{"location":"#assumptions","text":"This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have AWS device data ingested and the Splunk Add-on for AWS is installed. Familiarity with setting up a new Asset source in Enterprise Security.","title":"Assumptions"},{"location":"#about","text":"Info Description SA-AwsAssets 1.0.2 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x Splunk Add-on for AWS (Required) 6.x Quick Start","title":"About"},{"location":"configure/","text":"Configure \u00b6 Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/#configure","text":"Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/category/","text":"Category Field \u00b6 To update the category field modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Update Category"},{"location":"configure/category/#category-field","text":"To update the category field modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Category Field"},{"location":"configure/cleanup/","text":"Update Cleanup \u00b6 The saved search SA-AwsAssets - Lookup Cleanup runs hourly to remove old/stale device data from the Splunk KVstore . By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search SA-AwsAssets - Lookup Gen if it begins to send data again. Update Search Macro \u00b6 To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-AwsAssets . Set the \"Owner\" to Any . Click on sa_aws_assets_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\" Update Search Schedule \u00b6 It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-cleanup","text":"The saved search SA-AwsAssets - Lookup Cleanup runs hourly to remove old/stale device data from the Splunk KVstore . By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search SA-AwsAssets - Lookup Gen if it begins to send data again.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-search-macro","text":"To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-AwsAssets . Set the \"Owner\" to Any . Click on sa_aws_assets_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\"","title":"Update Search Macro"},{"location":"configure/cleanup/#update-search-schedule","text":"It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Search Schedule"},{"location":"configure/priority/","text":"Priority Field \u00b6 To update the priority field modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). All assets are set to \"medium\" by default and should be updated to suite your environment. The following is an example of how this may be set up. priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Update Priority"},{"location":"configure/priority/#priority-field","text":"To update the priority field modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). All assets are set to \"medium\" by default and should be updated to suite your environment. The following is an example of how this may be set up. priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Priority Field"},{"location":"configure/schedule/","text":"Update Schedule \u00b6 To update the schedule modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs every hour to update and continually build the Aws assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/schedule/#update-schedule","text":"To update the schedule modify the SA-AwsAssets - Lookup Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs every hour to update and continually build the Aws assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/best-practice/clone-search/","text":"Clone default saved search \u00b6 In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search SA-AwsAssets - Lookup Gen before making any changes. Clone \u00b6 Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-AwsAssets . Change \"Owner\" to All . For the search named \"SA-AwsAssets - Lookup Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish. Disable default search \u00b6 Disable the original search: For the search named \"SA-AwsAssets - Lookup Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Clone Saved Search"},{"location":"configure/best-practice/clone-search/#clone-default-saved-search","text":"In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search SA-AwsAssets - Lookup Gen before making any changes.","title":"Clone default saved search"},{"location":"configure/best-practice/clone-search/#clone","text":"Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-AwsAssets . Change \"Owner\" to All . For the search named \"SA-AwsAssets - Lookup Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish.","title":"Clone"},{"location":"configure/best-practice/clone-search/#disable-default-search","text":"Disable the original search: For the search named \"SA-AwsAssets - Lookup Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Disable default search"},{"location":"quickstart/install/","text":"Install \u00b6 Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. Download and install from Splunkbase . For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons Standalone Deployments (with Splunk ES) \u00b6 Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment Distributed Deployments \u00b6 Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment Distributed Deployment Compatibility \u00b6 Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Install"},{"location":"quickstart/install/#install","text":"Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. Download and install from Splunkbase . For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons","title":"Install"},{"location":"quickstart/install/#standalone-deployments-with-splunk-es","text":"Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment","title":"Standalone Deployments (with Splunk ES)"},{"location":"quickstart/install/#distributed-deployments","text":"Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment","title":"Distributed Deployments"},{"location":"quickstart/install/#distributed-deployment-compatibility","text":"Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Distributed Deployment Compatibility"},{"location":"quickstart/prerequisites/","text":"Prerequisites \u00b6 Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. Splunk Add-on for AWS 6.x AWS device metadata (sourcetype=aws:metadata) must be brought in prior to installing this add-on.","title":"Prerequisites"},{"location":"quickstart/prerequisites/#prerequisites","text":"Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. Splunk Add-on for AWS 6.x AWS device metadata (sourcetype=aws:metadata) must be brought in prior to installing this add-on.","title":"Prerequisites"},{"location":"quickstart/quickstart/","text":"Quick Start \u00b6 This add-on has a saved search and Asset configuration input enabled by default. Overview \u00b6 Updated default macro . Force initial build . Enable asset correlation . (optional) Update default saved search schedule . (optional) Disable existing asset sources . Update default macro \u00b6 Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_aws_assets_index index=`aws-index-value` Index definition for AWS metadata index ( sourcetype=aws:metadata ). Note The aws-index-value search macro is included with Splunk Enterprise Security and is set to aws_security by default. Update Macro Procedure \u00b6 Update the index definition to the correct index that contains the aws:metadata sourcetype. Perform one of the following: (recommended) Update via Splunk ES General Settings . Update via Macro Definition . ES General Settings \u00b6 option 1 (recommended option) (In Splunk Enterprise Security) Navigate to Configure > General > General Settings. From the \"App\" dropdown select SA-AwsAssets . Update the SA-AwsAssets Index definition and click \"Save.\" Macro Definition \u00b6 option 2 Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-AwsAssets . Set the \"Owner\" dropdown to any . Click the macro named sa_aws_assets_index to update the index definition. Force Initial Build \u00b6 The initial build of the AWS assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search SA-AwsAssets - Lookup Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from AWS. Enable asset correlation \u00b6 Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save. Disable existing asset sources \u00b6 optional It may be possible that you have existing Asset Lookups defined. If AWS is widely deployed in your environment the existing lookups may no longer be needed. Update default saved search schedule \u00b6 optional The default saved search runs once every hour to update and continually build the AWS assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Quickstart"},{"location":"quickstart/quickstart/#quick-start","text":"This add-on has a saved search and Asset configuration input enabled by default.","title":"Quick Start"},{"location":"quickstart/quickstart/#overview","text":"Updated default macro . Force initial build . Enable asset correlation . (optional) Update default saved search schedule . (optional) Disable existing asset sources .","title":"Overview"},{"location":"quickstart/quickstart/#update-default-macro","text":"Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_aws_assets_index index=`aws-index-value` Index definition for AWS metadata index ( sourcetype=aws:metadata ). Note The aws-index-value search macro is included with Splunk Enterprise Security and is set to aws_security by default.","title":"Update default macro"},{"location":"quickstart/quickstart/#update-macro-procedure","text":"Update the index definition to the correct index that contains the aws:metadata sourcetype. Perform one of the following: (recommended) Update via Splunk ES General Settings . Update via Macro Definition .","title":"Update Macro Procedure"},{"location":"quickstart/quickstart/#es-general-settings","text":"option 1 (recommended option) (In Splunk Enterprise Security) Navigate to Configure > General > General Settings. From the \"App\" dropdown select SA-AwsAssets . Update the SA-AwsAssets Index definition and click \"Save.\"","title":"ES General Settings"},{"location":"quickstart/quickstart/#macro-definition","text":"option 2 Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-AwsAssets . Set the \"Owner\" dropdown to any . Click the macro named sa_aws_assets_index to update the index definition.","title":"Macro Definition"},{"location":"quickstart/quickstart/#force-initial-build","text":"The initial build of the AWS assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search SA-AwsAssets - Lookup Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from AWS.","title":"Force Initial Build"},{"location":"quickstart/quickstart/#enable-asset-correlation","text":"Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save.","title":"Enable asset correlation"},{"location":"quickstart/quickstart/#disable-existing-asset-sources","text":"optional It may be possible that you have existing Asset Lookups defined. If AWS is widely deployed in your environment the existing lookups may no longer be needed.","title":"Disable existing asset sources"},{"location":"quickstart/quickstart/#update-default-saved-search-schedule","text":"optional The default saved search runs once every hour to update and continually build the AWS assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-AwsAssets . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SA-AwsAssets - Lookup Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update default saved search schedule"},{"location":"reference/all-configurations/","text":"All Configurations \u00b6 Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description SA-AwsAssets - Lookup Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file sa_aws_assets . SA-AwsAssets - Lookup Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: sa_aws_assets . sa_aws_assets lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVstore collection sa_aws_assets_collection . sa_aws_assets_collection KVStore collection n/a** collections.conf KVstore configuration. sa_aws_assets_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the aws index that contains the sourcetype aws:metadata . sa_aws_assets_retention Search macro Settings > Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://sa_aws_assets Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load AWS assets into the asset database. *CLI locations are relative to ../default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection sa_aws_assets_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/all-configurations/#all-configurations","text":"Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description SA-AwsAssets - Lookup Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file sa_aws_assets . SA-AwsAssets - Lookup Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: sa_aws_assets . sa_aws_assets lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVstore collection sa_aws_assets_collection . sa_aws_assets_collection KVStore collection n/a** collections.conf KVstore configuration. sa_aws_assets_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the aws index that contains the sourcetype aws:metadata . sa_aws_assets_retention Search macro Settings > Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://sa_aws_assets Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load AWS assets into the asset database. *CLI locations are relative to ../default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection sa_aws_assets_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/asset-mapping/","text":"Asset Database Mapping \u00b6 The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field aws:metadata sourcetype Example value Multivalue allowed ip NetworkInterfaces{}.PrivateIpAddress 10.15.23.8 true mac NetworkInterfaces{}.MacAddress 61:se:e3:1s:7r:38 true nt_host NetworkInterfaces{}.Association.PublicDnsName + NetworkInterfaces{}.PrivateDnsName + NetworkInterfaces{}.PrivateIpAddresses{}.Association.PublicDnsName dev-server01 false dns dns dev-server01.example.com true owner n/a not mapped n/a priority see Configure Priority medium false lat from iplocation of NetworkInterfaces{}.Association.PublicIp 40.76073 false long from iplocation of NetworkInterfaces{}.Association.PublicIp -111.89096 false city from iplocation of NetworkInterfaces{}.Association.PublicIp Salt Lake City false country from iplocation of NetworkInterfaces{}.Association.PublicIp United States false bunit n/a not mapped true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected n/a not mapped n/a should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database mapping"},{"location":"reference/asset-mapping/#asset-database-mapping","text":"The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field aws:metadata sourcetype Example value Multivalue allowed ip NetworkInterfaces{}.PrivateIpAddress 10.15.23.8 true mac NetworkInterfaces{}.MacAddress 61:se:e3:1s:7r:38 true nt_host NetworkInterfaces{}.Association.PublicDnsName + NetworkInterfaces{}.PrivateDnsName + NetworkInterfaces{}.PrivateIpAddresses{}.Association.PublicDnsName dev-server01 false dns dns dev-server01.example.com true owner n/a not mapped n/a priority see Configure Priority medium false lat from iplocation of NetworkInterfaces{}.Association.PublicIp 40.76073 false long from iplocation of NetworkInterfaces{}.Association.PublicIp -111.89096 false city from iplocation of NetworkInterfaces{}.Association.PublicIp Salt Lake City false country from iplocation of NetworkInterfaces{}.Association.PublicIp United States false bunit n/a not mapped true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected n/a not mapped n/a should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database Mapping"},{"location":"reference/category/","text":"Category \u00b6 Default category field mapping \u00b6 Mapped Field sourcetype=aws:metadata Event Field Example value availability_zone Placement.AvailabilityZone us-east-1d enabled enabled true group_id SecurityGroups{}.GroupId sg-934752093485034 group_name SecurityGroups{}.GroupName webserver hypervisor Hypervisor xen image_id ImageId ami-83477fed042321 instance_type InstanceType t2.micro launch_time LaunchTime 10/28/22 19:04:38 utc monitoring Monitoring.State disabled public_ip NetworkInterfaces{}.Association.PublicIp 0.0.0.0 region Region us-east-1 state State.Name running subnet_id NetworkInterfaces{}.SubnetId subnet-8394d882 tags custom_tag dev web server vpc_id NetworkInterfaces{}.VpcId vpc-0c38d38eae842145 splunk_last_updated now() 09/29/22 18:55:51 mdt Full example of category value \u00b6 availability_zone: us-east-1d enabled: true gen: sa-aws-assets group_id: sg-046036e7384042b7 group_name: webserver hypervisor: xen image_id: ami-0c02fb53sd46c7d316 instance_type: t2.medium launch_time: 10/28/22 19:04:38 utc monitoring: disabled public_ip: 0.0.0.0 region: ec2_instances splunk_last_updated: 10/28/22 20:21:39 utc state: running subnet_id: subnet-0c08bkd3ae32c536b tags: name:web server vpc_id: vpc-0c835c7sx3dsrca4f8","title":"Category"},{"location":"reference/category/#category","text":"","title":"Category"},{"location":"reference/category/#default-category-field-mapping","text":"Mapped Field sourcetype=aws:metadata Event Field Example value availability_zone Placement.AvailabilityZone us-east-1d enabled enabled true group_id SecurityGroups{}.GroupId sg-934752093485034 group_name SecurityGroups{}.GroupName webserver hypervisor Hypervisor xen image_id ImageId ami-83477fed042321 instance_type InstanceType t2.micro launch_time LaunchTime 10/28/22 19:04:38 utc monitoring Monitoring.State disabled public_ip NetworkInterfaces{}.Association.PublicIp 0.0.0.0 region Region us-east-1 state State.Name running subnet_id NetworkInterfaces{}.SubnetId subnet-8394d882 tags custom_tag dev web server vpc_id NetworkInterfaces{}.VpcId vpc-0c38d38eae842145 splunk_last_updated now() 09/29/22 18:55:51 mdt","title":"Default category field mapping"},{"location":"reference/category/#full-example-of-category-value","text":"availability_zone: us-east-1d enabled: true gen: sa-aws-assets group_id: sg-046036e7384042b7 group_name: webserver hypervisor: xen image_id: ami-0c02fb53sd46c7d316 instance_type: t2.medium launch_time: 10/28/22 19:04:38 utc monitoring: disabled public_ip: 0.0.0.0 region: ec2_instances splunk_last_updated: 10/28/22 20:21:39 utc state: running subnet_id: subnet-0c08bkd3ae32c536b tags: name:web server vpc_id: vpc-0c835c7sx3dsrca4f8","title":"Full example of category value"},{"location":"reference/example/","text":"Example Output \u00b6 See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"reference/example/#example-output","text":"See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"releases/","text":"Release notes \u00b6 v1.0.2 December 20, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x What's Changed \u00b6 Added macro and retention definition to ES General Settings in #10 Full Changelog : v1.0.1...v1.0.2 Known issues \u00b6 Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1 Issues can be reported on the SA-AwsAssets's Github page .","title":"Release Notes"},{"location":"releases/#release-notes","text":"","title":"Release notes"},{"location":"releases/#v102-december-20-2022","text":"","title":"v1.0.2 December 20, 2022"},{"location":"releases/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x","title":"Compatibility"},{"location":"releases/#whats-changed","text":"Added macro and retention definition to ES General Settings in #10 Full Changelog : v1.0.1...v1.0.2","title":"What's Changed"},{"location":"releases/#known-issues","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1 Issues can be reported on the SA-AwsAssets's Github page .","title":"Known issues"},{"location":"releases/release-history/","text":"Release history \u00b6 v1.0.1 November 2, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x What's Changed \u00b6 Fixed duplicate nt_host field - #5 Known issues \u00b6 Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1 v1.0.0 October 28, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x New \u00b6 Initial release Known issues \u00b6 Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1","title":"Release History"},{"location":"releases/release-history/#release-history","text":"","title":"Release history"},{"location":"releases/release-history/#v101-november-2-2022","text":"","title":"v1.0.1 November 2, 2022"},{"location":"releases/release-history/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x","title":"Compatibility"},{"location":"releases/release-history/#whats-changed","text":"Fixed duplicate nt_host field - #5","title":"What's Changed"},{"location":"releases/release-history/#known-issues","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1","title":"Known issues"},{"location":"releases/release-history/#v100-october-28-2022","text":"","title":"v1.0.0 October 28, 2022"},{"location":"releases/release-history/#compatibility_1","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x Splunk Add-on for AWS 6.x","title":"Compatibility"},{"location":"releases/release-history/#new","text":"Initial release","title":"New"},{"location":"releases/release-history/#known-issues_1","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #1","title":"Known issues"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on GitHub . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If Aws is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with Aws Data The asset database may show no Aws data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the Aws assets lookup before the first scheduled run. Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation.","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on GitHub . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If Aws is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with Aws Data The asset database may show no Aws data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the Aws assets lookup before the first scheduled run. Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation.","title":"Troubleshooting"},{"location":"troubleshooting/solution-guides/asset-merge/","text":"Asset Merge \u00b6 It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If Aws is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"},{"location":"troubleshooting/solution-guides/asset-merge/#asset-merge","text":"It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If Aws is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"}]}